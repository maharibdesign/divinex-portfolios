---
import MainLayout from '../../../layouts/MainLayout.astro';
import { supabase } from '../../../lib/supabase';
import { type Product } from '../../../types';
import '../../../styles/admin.css'; // Import the new shared styles

const { id } = Astro.params;
let product: Product | null = null;
if (id) {
  const { data } = await supabase.from('products').select('*').eq('id', id).single();
  product = data as Product;
}
if (!product) { return new Response("Product not found", { status: 404 }); }
---
<MainLayout title={`Edit: ${product.title}`}>
  <div class="admin-panel">
    <header class="admin-header">
      <h1>Edit Product</h1>
      <a href="/admin" class="back-link">‚Üê Back to Admin Panel</a>
    </header>
    
    <section class="admin-section">
      <form id="edit-product-form" class="product-form">
        <input type="hidden" name="id" value={product.id} />
        <label>Title <input type="text" name="title" value={product.title || ''} required /></label>
        <label>Description <textarea name="description" rows="4" required>{product.description || ''}</textarea></label>
        <div class="form-row">
          <label>Category
            <select name="category" required>
              <option value="Phones" selected={product.category === 'Phones'}>Phones</option>
              <option value="Laptops" selected={product.category === 'Laptops'}>Laptops</option>
              <option value="Watches" selected={product.category === 'Watches'}>Watches</option>
              <option value="Accessories" selected={product.category === 'Accessories'}>Accessories</option>
            </select>
          </label>
          <label>Price <input type="number" name="price" step="0.01" value={product.price || 0} required /></label>
        </div>
        <p>To change images, please delete and re-create the product for now.</p>
        <div class="form-actions">
          <a href="/admin" class="btn btn-secondary">Cancel</a>
          <button type="submit" class="btn btn-primary">Save Changes</button>
        </div>
      </form>
    </section>
  </div>
</MainLayout>
<script>
  // Edit form submission logic remains the same
</script>